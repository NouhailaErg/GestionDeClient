<html>

<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>


</head>

<body>

  <div class="row">
    <h2 style="text-align: center;margin-top: 22px; margin-bottom: 50;">Liste des Appliances</h2>
  </div>
  <!-- <div class="form-group">
    <input
    style="margin-left: 150px;"
      type="text"
      class="form-control w-25 "
      placeholder="Search..."
      [(ngModel)]="filterTerm"
    />
    
  </div> -->
  
  <button class="fa fa-plus-square-o fa-2x" (click)="open(content)" style="color: chartreuse;margin-left: 150px;"></button>
  <button class="fa fa-file-pdf-o  fa-2x" style="color:red;margin-left: 15px; margin-top: 10px;" (click)="downloadFile('sample.pdf')"></button>
  <input
  style="margin-left: 150px; margin-top: 15px;"
    type="text"
    class="form-control w-25 "
    placeholder="Search..."
    [(ngModel)]="filterTerm"
  />
  <!-- <div>
    <button class="btn btn-outline-dark" (click)="open(content)" style="text-align: center;margin-left: 150px;">ADD A
      NEW APPLIANCE</button>
      <button class="fa fa-file-pdf-o  fa-2x" style="color:red;margin-left: 15px; margin-top: 10px;" (click)="downloadFile('sample.pdf')"></button>
    </div> -->


  <div class="container mt-3">
  <table class="table table-striped table-bordered" >
    <thead>
      <tr>
        <th [width]="250"> LIBELLE </th>
        <th> TYPE</th>
        <th> DBID </th>
        <!-- <th> DISPONIBILITE</th> -->
        <th> REFERENCE </th>
        <th [width]="100"> HISTORIQUE </th>
        <th [width]="95">ACTION</th>  
      <th [width]="95"></th> </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let appliance of appliance | filter: filterTerm | paginate: { itemsPerPage: 5, currentPage: page , totalItems : totalLenght }">
        <td> {{ appliance.libelle }} </td>
        <td> {{ appliance.type.libelle}} </td>
        <td> {{ appliance.dbid }} </td>
        <!-- <td> {{appliance.disponibilite}}</td> -->
        <td> {{ appliance.reference }} </td>
        <td> <button *ngIf="appliance.disponibilite" (click)="Details(appliance)"(click)='toggleShowTable()' class="btn btn-outline-info" >Details</button>
        </td>

        <td >
        <button (click)="openEdit(Editcontent,appliance.id_appliance)" class = "btn btn-primary">Update</button></td>
         <td *ngIf="!appliance.disponibilite" > <button *ngIf="appliance.id_appliance" (click)="deleteAppliance(appliance.id_appliance)" class = "btn btn-danger">Delete</button>
          </td>
         

        
      </tr>
    </tbody>
    <pagination-controls class="text-center" (pageChange)="page = $event"></pagination-controls>
  </table>
</div>

  <ng-template #content let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Add a new APPLIANCE</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="applianceForm" (ngSubmit)="onSubmit()" novalidate>


        <div class="form-group">
          <label for="libelle">LIBELLE</label>
          <div class="input-group">
            <input formControlName="libelle" class="form-control">
          </div>
        </div>
        <div class="form-group">  
          <label for="type">TYPE</label>
          <ng-select [items]="type" bindLabel="libelle"  formControlName="type">
        </ng-select>
        </div>

        <div class="form-group">
          <label for="dbid">DBID</label>
          <div class="input-group">
            <input formControlName="dbid" class="form-control">
          </div>
        </div>

        <div class="form-group">
          <label for="reference">REFERENCE</label>
          <div class="input-group">
            <input formControlName="reference" class="form-control">
          </div>
        </div>
        <div class="border text-center">
          <button class="btn btn-outline-dark" (click)="modal.close('Save click')">Submit</button>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Cancel</button>
    </div>
  </ng-template>

  <ng-template #Editcontent let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">UPDATE APPLIANCE</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="EditForm" (ngSubmit)="onSave()" novalidate>

        <div class="form-group">
          <label for="libelle">LIBELLE</label>
          <div class="input-group">
            <input formControlName="libelle" class="form-control">
          </div>
        </div>
        <div class="form-group">
          <label for="type">TYPE</label>
            <ng-select [items]="type" bindLabel="libelle"  formControlName="type">
          </ng-select>
        </div>
        <div class="form-group">
          <label for="dbid">DBID</label>
          <div class="input-group">
            <input formControlName="dbid" class="form-control">
          </div>
        </div>

        <div class="form-group">
          <label for="reference">REFERENCE</label>
          <div class="input-group">
            <input formControlName="reference" class="form-control">
          </div>
        </div>
        <div class="border text-center">
          <button class="btn btn-outline-dark" (click)="modal.close('Save click')">Submit</button>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Cancel</button>
    </div>
  </ng-template>


<div class="container mt-3">
  <table *ngIf='showTable' class="table table-striped table-bordered" >
    <thead>
        <tr>

            <th> ID_APPLIANCE </th>
            <th > ID_CLIENT</th>
            <th> DATE DEBUT </th>
            <th> DATE FIN </th>
            <th> DESCRIPTION </th>
            <th> COMPTE MANAGER</th>
            <th> INGENIEUR CS </th>
            <th> ANALYSE CS </th>
            <th> LIBELLE </th>
            
        </tr>
    </thead>
    <tbody>
        <tr *ngFor = "let pov of pov  | paginate: { itemsPerPage: 3, currentPage: page , totalItems : totalLenght }" >
 
           <td> {{ pov.appliance.libelle }} </td>
        <td (click)="openContact(pov.client)"><strong> {{ pov.client.libelle}}</strong> </td>
            <!-- <td  (click)="getClientinfo(pov.client)" (click)='toggleShowTablec()'> {{ pov.client.libelle}} </td> -->
            <td> {{ pov.date_debut | date:'dd-MM-yyyy '}} </td>
            <td> {{ pov.date_fin | date:'dd-MM-yyyy '}} </td>
            <td > {{ pov.description}} </td>
            <td> {{ pov.compteManager }} </td>
            <td> {{ pov.ingenieurCybersecurite}} </td>
            <td> {{ pov.analyseCybersecurity}} </td>
        <td (click)="openSceance(pov)"> <strong>{{ pov.libelle_pov }}</strong> </td> 
           
        </tr>
    </tbody>
</table>
</div>


</body>

</html>